<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nai-Nai App</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <div id="pantalla-referidos" class="modal-full" style="display:none; z-index: 3000;">
        <div class="box-intro">
            <h1>ğŸ’ Nai-Nai Future</h1>
            <p>En el futuro, ganarÃ¡s dinero compartiendo esta app.</p>
            <hr>
            <p>Â¿QuiÃ©n te invitÃ³?</p>
            <input type="text" id="ref-input" placeholder="Ej: usuario.Nai o Google">
            <button onclick="guardarReferido()" class="btn-primary">Entrar a Nai-Nai</button>
        </div>
    </div>

    <div id="auth-container" class="modal-full" style="display:none; z-index: 2000;">
        <div class="box-intro">
            <img src="https://i.ibb.co/hF6VHB5F/1ec8541e-1.png" class="logo-grande">
            <h2>Nai-Nai</h2>
            <p>Comunidad de Confianza</p>
            <button onclick="loginGoogle()" class="btn-google">Entrar con Google</button>
            <button onclick="entrarInvitado()" class="btn-invitado">Entrar como Invitado</button>
        </div>
    </div>

    <div id="app-interface" style="display:none;">
        
        <div id="feed-vertical" class="feed-container">
            </div>

        <div class="nav-bar">
            <button onclick="recargarFeed()">ğŸ </button>
            <button onclick="abrirEditor()" class="btn-plus">â•</button>
            <button onclick="abrirPerfil()">ğŸ‘¤</button>
        </div>
    </div>

    <div id="modal-editor" class="modal-overlay" style="display:none;">
        <div class="modal-content editor-panel">
            <h3>ğŸ¬ Nuevo Video</h3>
            
            <div class="preview-box">
                <video id="preview-v" loop playsinline></video>
                <div class="marca-agua-preview" id="watermark-preview">Tu.Nai</div>
            </div>

            <div class="editor-tools">
                <span onclick="setFilter('none')">ğŸš«</span>
                <span onclick="setFilter('grayscale(1)')">âš«âšª</span>
                <span onclick="setFilter('sepia(1)')">bf</span>
                <span onclick="setFilter('hue-rotate(90deg)')">ğŸ‘½</span>
                <span onclick="setFilter('contrast(200%)')">ğŸ”¥</span>
            </div>

            <input type="text" id="v-titulo" placeholder="TÃ­tulo divertido...">
            <div class="switch-row">
                <label>Â¿Es contenido original?</label>
                <select id="v-original" onchange="toggleFuente()">
                    <option value="true">âœ… SÃ­, es mÃ­o</option>
                    <option value="false">âŒ No (Dar crÃ©ditos)</option>
                </select>
            </div>
            <input type="text" id="v-fuente" placeholder="Link del creador original" style="display:none;">
            
            <div class="switch-row">
                <label>Marca de Agua .Nai</label>
                <input type="checkbox" id="v-watermark" checked onchange="toggleWatermarkVis()">
            </div>
            
            <input type="file" id="file-input" accept="video/*" onchange="cargarVideoFile(event)" style="margin-top:10px;">

            <div class="action-buttons">
                <button onclick="cerrarModal('modal-editor')" class="btn-sec">Cancelar</button>
                <button onclick="subirVideo()" class="btn-primary">PUBLICAR</button>
            </div>
        </div>
    </div>

    <div id="modal-perfil" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <div class="perfil-header">
                <img id="p-avatar" src="" class="avatar-perfil">
                <div>
                    <h2 id="p-alias">Usuario</h2>
                    <div id="p-cuenta-nai" class="badge-nai"></div>
                    <small>ğŸ›¡ï¸ GUA: <span id="p-gua">0</span></small>
                </div>
            </div>

            <button onclick="gestionarCuentaNai()" class="btn-full-nai">âœ¨ GestiÃ³n Cuenta .Nai</button>
            <button onclick="abrirOpcionesAvanzadas()" class="btn-full-opt">âš™ï¸ Opciones Avanzadas</button>
            <button onclick="cerrarSesion()" class="btn-danger">Cerrar SesiÃ³n</button>
            <button onclick="cerrarModal('modal-perfil')" class="btn-sec">Volver</button>
        </div>
    </div>

    <div id="modal-opciones" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <h3>ğŸ‘» Privacidad Fantasma</h3>
            <p style="font-size:0.8rem; color:#aaa;">Controla quiÃ©n te ve.</p>
            
            <div class="switch-row">
                <span>Ocultar al ver videos</span>
                <input type="checkbox" id="check-priv-ver" onchange="cambiarPrivacidad('ver')">
            </div>
            <div class="switch-row">
                <span>AnÃ³nimo al comentar</span>
                <input type="checkbox" id="check-priv-com" onchange="cambiarPrivacidad('comentar')">
            </div>

            <hr>
            <button onclick="cambiarPassNai()" class="btn-sec">ğŸ”‘ Cambiar ContraseÃ±a .Nai</button>
            <button onclick="cerrarModal('modal-opciones')" class="btn-primary">Listo</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
